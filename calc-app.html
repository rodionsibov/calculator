<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">    
    <title>Calculator for Consumer cooperative of joint savings</title>

    <style>

      /* @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap'); */
      @import url('https://fonts.googleapis.com/css2?family=Ubuntu&display=swap');

      :root {
	  --caption: #ffc38b;
	  --border-bottom: #ff926b;
	  --tr-hover: #fff3cd;
	  
      }
      
      
      * {
	  margin: 0;
	  box-sizing: border-box;
      }


      
      @keyframes appear {
	  to {
	      opacity: 1
	  }
      }
      
      body {
	  animation: appear 2s both;
	  opacity: 0;
	  color: dimgray;
	  font-size: 12px;
	  width: 90%;
	  margin: 30px auto;
	  display: flex;
	  /* font-family: 'Roboto', sans-serif; */
	  font-family: 'Ubuntu', sans-serif;
	  flex-wrap: wrap;
	  filter: hue-rotate(0deg);   	 	  
      }

      @media (max-width: 1100px) {

	  
      	  .grow-sum, .grow-transact {
      	      min-width: 70%;
	      margin: 0 auto;
      	  }
      }
      
      @media (max-width: 600px) {

	  
      	  .grow-sum, .grow-transact {
      	      min-width: 100%;
      	  }
      }

      
      /* button { */
      /* 	  margin-top: 10px; */
      /* 	  outline: none; */
      /* 	  border: none; */
      /* 	  background: none; */
      /* 	  transition: all 0.2s; */
      /* } */

      
      /* button:hover { */
      /* 	  filter: brightness(110%); */
      /* 	  transform: scale(1.1); */
      /* } */

      /* button:active { */
      /* 	  transform: translateY(1px); */
      /* } */
      
      .col {
	  width: 100%;
	  padding: 10px;
      }

      .grow-sum {
      	  width: 30%;
      }


      .grow-transact {
	  overflow: auto;
      	  width: 70%;
	  text-align: center;
      }
      
      h1 {
	  position: relative;
	  text-align: center;
	  font-size: 16px;
	  margin: 40px auto 20px;
      }

      h1:hover {
	  color: black;
      }



      .info {
	  background-image: linear-gradient(-137deg, rgba(1,1,1,0.02) 7%, rgba(255,255,255,1) 6%);
	  padding: 30px;
	  border-radius: 15px;
	  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
	  transition: all 0.1s;
	  position: relative;
	  
	  border-top: 2px solid var(--caption);
      }
      

      .info:hover {
	  transform: scale(1.01);
	  box-shadow: 0 15px 20px rgba(0, 0, 0, 0.2);        
      }

      ul {
	  font-size: 13px;
	  padding-left: 20px;
      }
      
      .abbr {
	  padding: 4px;
	  background: var(--tr-hover);
	  border-radius: 4px;
	  -webkit-box-decoration-break: clone;
	  line-height: 1.5;

      }
      
      li {
	  margin-bottom: 10px;

      }

      p:first-child, p:nth-of-type(2) {
	  border-bottom: 1px solid #eee;
      }
      
      p {
	  font-size: 13px;
	  line-height: 1.4;
	  margin-bottom: 15px;
	  padding-bottom: 10px;

      }

      p:hover, li:hover {
	  color: black;
      }


      caption {
	  transition: all 0.2s;
	  position: relative;
	  font-weight: bold;
	  letter-spacing: 1px;
	  text-transform: uppercase;
	  background-image: linear-gradient(-1deg, var(--border-bottom) 10%, var(--caption) 20%);


	  padding: 10px;
	  border-top-left-radius: 5px;
	  border-top-right-radius: 5px;
	  border-bottom: 1px solid var(--border-bottom);
      }

      caption .material-icons {
	  position: absolute;
	  top: 5px;
	  left: 5px;
	  font-size: 22px;

      }

      
      h1 .material-icons {
	  font-size: 20px;

      }


      #tab-tra {

	  
	  padding: 10px;
	  margin-bottom: 20px;
	  width: 100%;
	  border-bottom-left-radius: 5px;
	  border-bottom-right-radius: 5px;
	  /* border-collapse: collapse; */
	  /* border-spacing: 0; */

	  box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.05);
	  transition: all 0.1s;
	  
      }
      
      table:not(#tab-tra) {

	  /* border-spacing: 0; */


	  
	  padding: 10px;
	  margin-bottom: 20px;
	  width: 100%;
	  border-bottom-left-radius: 5px;
	  border-bottom-right-radius: 5px;
	  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
	  transition: all 0.1s;

      }

      td:hover, th:hover, caption:hover {
	  font-weight: bold;
	  color: black;
      }


      
      table:hover:not(#tab-tra) {
	  transform: scale(1.01);
	  box-shadow: 0 15px 20px rgba(0, 0, 0, 0.2);        

      }

      tr:nth-child(even) {
	  background: whitesmoke;
      }

      tr:hover {
	  background: var(--tr-hover);
      }
      
      #tab-tra tr:last-child:hover {
	  background: none;
      }
      
      #tab-tra tr:last-child {

      }

      td, th {
	  padding: 5px;
	  width: 100px;
      }

      .grow-sum th {
	  text-align: right;
      }
      
      input {
	  font-family: inherit;	  
	  width: 100%;
	  border: none;
	  background: none;
      }

      input:hover {
	  font-weight: bold;
	  color: black;

      }

      footer {
	  width: 100%;
	  text-align: center;
      }

      
    </style>
  </head>
  <body>

    <div class="col grow-sum">

      <table id="tab-input">
	<caption><span class="material-icons">create</span> Исходные данные</caption>
	<tr>
	  <th><label for="input-sum">Сумма займа, руб.</label></th>
	  <td>
	    <input id="input-sum" type="number" step="1000" value="500000" min="10" required>
	  </td>
	</tr>
	<tr>
	  <th><label for="input-term">Срок займа, мес.</th>
	  <td>
	    <input type="number" id="input-term" min="1" max="120" value="48" required>
	  </td>
	</tr>
	<tr>
	  <th><label for="input-date">Узнать <abbr title="Коэффициент участия пайщика">КУПы</abbr>
	      и <abbr title="Ежедневный коэффициент участия">ЕКУПы</abbr>
	      на:</label></th>
	  <td>
	    <input id="input-date" type="date" required>
	  </td>
	</tr>

      </table>
      

      <table id="tab-result">
	<caption><span class="material-icons">trending_up</span> Результаты расчета</caption>
	<tr>
	  <th>Общая сумма накоплений</th>
	  <td id="result-sum">0</td>
	</tr>
	<tr>
	  <th><abbr title="Ежедневный коэффициент участия пайщика">ЕКУП</abbr>
	  </th>
	  <td id="result-ecup">0</td>
	</tr>
	<tr>
	  <th><abbr title="Коэффициент участия пайщика">КУП</abbr>
	  </th>
	  <td id="result-cup">0</td>
	</tr>
	<tr>
	  <th><abbr title="Членский взнос">ЧВ</abbr>
	  </th>
	  <td id="result-member-contribution">0</td>
	</tr>
	<tr>
	  <th>Ежемесячный платеж в мес.</th>
	  <td id="result-mounthly-payment">0</td>
	</tr>
	
      </table>

      <h1>Инструкция <span class="material-icons">help</span></h1>
      <div class="info">
	<p>Заполните графы с исходными данными (сумма займа, срок займа, дату на которую производите расчет).</p>
	<p>Укажите сумму и дату каждого внесения денежных средств в программу <b>"ТРАНЗАКЦИИ"</b>. </p>
	<p>На основании внесенных данных производится расчет:</p>
	<ul>
	  <li><span class="abbr">Общая сумма вложений.</span></li>
	  <li><span class="abbr"><b>ЕКУП</b> - ежедневный коэффициент участия пайщика.</span></li>
	  <li><span class="abbr"><b>КУП</b> - коэффициент участия пайщика.</span></li>
	  <li><span class="abbr"><b>ЧВ</b> - членский взнос, ежемесячный взнос).</span></li>
	</ul>
      </div>
    </div>
    
    <div class="col grow-transact">
      <table id="tab-tra">
	<caption><span class="material-icons">payment</span>Транзакции</caption>
	<tr>
	  <th>Транзакции</th>
	  <th>Сумма</th>
	  <th>Дата</th>
	  <th>Кол-во дней</th>
	  <th><abbr title="Коэффициент участия пайщика">КУП</abbr></th>
	  <th>Значение</th>
	  <th><abbr title="Ежедневный коэффициент участия пайщика">ЕКУП</abbr></th>
	  <th>Значение</th>
	</tr>

      </table>
    </div>

    <footer>
      <small>Written, designed, and built by Rodion Sibov, a designer who you can find on <a href="https://github.com/rodionsibov">GitHub </a>, or good old-fashioned <a href="mailto:rodionsibov@gmail.com">Email.</small>
    </footer>
    <script>
      

      const inputSum = document.querySelector('#input-sum')
      const inputTerm = document.querySelector('#input-term')
      const inputDate = document.querySelector('#input-date')
      const resultSum = document.querySelector('#result-sum')
      const resultEcup = document.querySelector('#result-ecup')
      const resultCup = document.querySelector('#result-cup')
      const resultMc = document.querySelector('#result-member-contribution')
      const resultMp = document.querySelector('#result-mounthly-payment')


      //add table

      const table = document.querySelector('#tab-tra');
      const transactNum = 50

      for (let i = 0; i < transactNum; i++) {

	  const row = table.insertRow();
	  const cell1 = row.insertCell(0);
	  const cell2 = row.insertCell(1);
	  const cell3 = row.insertCell(2);
	  const cell4 = row.insertCell(3);
	  const cell5 = row.insertCell(4);
	  const cell6 = row.insertCell(5);
	  const cell7 = row.insertCell(6);
	  const cell8 = row.insertCell(7);

	  
	  cell1.innerHTML = '<label for="input-sum-transact' + Number(i+1) + '">Транзакция №' + Number(i+1) + '</label>';
	  cell2.innerHTML = '<input class="sum-transact" id="input-sum-transact' + Number(i+1) + '" type="number" step="10" min="10" value="0" required>';

	  cell3.innerHTML = '<input class="date-transact" type="date" required>';
	  cell4.innerHTML = '<span class="day-transact">0</span>';;
	  cell5.innerHTML = 'КУП ' + Number(i + 1);
	  cell6.innerHTML = '<span class="cup-transact">0</span>';
	  cell7.innerHTML = 'ЕКУП ' + Number(i + 1);
	  cell8.innerHTML = '<span class="ecup-transact">0</span>';

	  
      }



      window.onload = () => {
	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('sum-transact')[i]
	      localStorage.getItem(`transaction ${i+1}`) === null
		  ? localStorage.setItem(`transaction ${i+1}`, cell.value)
		  : cell.value = localStorage.getItem(`transaction ${i+1}`)	      
	  }

	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('cup-transact')[i]
	      localStorage.getItem(`cup ${i+1}`) === null
		  ? localStorage.setItem(`cup ${i+1}`, cell.innerHTML)
		  : cell.innerHTML = localStorage.getItem(`cup ${i+1}`)	      
	  }

	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('ecup-transact')[i]
	      localStorage.getItem(`ecup ${i+1}`) === null
		  ? localStorage.setItem(`cup ${i+1}`, cell.innerHTML)
		  : cell.innerHTML = localStorage.getItem(`ecup ${i+1}`)	      
	  }

	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('date-transact')[i]
	      localStorage.getItem(`date transaction ${i+1}`) === null
		  ? localStorage.setItem(`date transaction ${i+1}`, cell.value)
		  : cell.value = localStorage.getItem(`date transaction ${i+1}`)	      
	  }

	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('day-transact')[i]
	      localStorage.getItem(`day transaction ${i+1}`) === null
		  ? localStorage.setItem(`day transaction ${i+1}`, cell.innerHTML)
		  : cell.innerHTML = localStorage.getItem(`day transaction ${i+1}`)
	  }

	  localStorage.getItem('result sum') === null
	      ? localStorage.setItem('result sum', '0')
	      : resultSum.innerHTML = localStorage.getItem('result sum')

	  localStorage.getItem('input sum') === null
	      ? localStorage.setItem('input sum', inputSum.value)
	      : inputSum.value = localStorage.getItem('input sum')

	  localStorage.getItem('input term') === null
	      ? localStorage.setItem('input term', inputTerm.value)
	      : inputTerm.value = localStorage.getItem('input term')
	  
	  localStorage.getItem('input date') === null
	      ? localStorage.setItem('input date', inputDate.value)
	      : inputDate.value = localStorage.getItem('input date')

	  localStorage.getItem('result mounthly payment') === null
	      ? localStorage.setItem('result mounthly payment', resultMp.innerHTML)
	      : resultMp.innerHTML = localStorage.getItem('result mounthly payment')

	  localStorage.getItem('result member contribution') === null
	      ? localStorage.setItem('result member contribution', resultMc.innerHTML)
	      : resultMc.innerHTML = localStorage.getItem('result member contribution')

	  localStorage.getItem('result cup') === null
	      ? localStorage.setItem('result cup', resultCup.innerHTML)
	      : resultCup.innerHTML = localStorage.getItem('result cup')

	  localStorage.getItem('result ecup') === null
	      ? localStorage.setItem('result ecup', resultEcup.innerHTML)
	      : resultEcup.innerHTML = localStorage.getItem('result ecup')

      }


      document.oninput = () => {
	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('sum-transact')[i].value
	      localStorage.setItem(`transaction ${i+1}`, cell)
	  }

	  let sumCells = 0
	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('sum-transact')[i].value
	      sumCells += +cell
	  }
	  resultSum.innerHTML = sumCells
	  localStorage.setItem('result sum', sumCells)

	  localStorage.setItem('input sum', inputSum.value)
	  localStorage.setItem('input term', inputTerm.value)
	  localStorage.setItem('input date', inputDate.value)

	  resultMp.innerHTML = Math.floor((+inputSum.value - +resultSum.innerHTML) / +inputTerm.value)
	  localStorage.setItem('result mounthly payment', resultMp.innerHTML)

	  resultMc.innerHTML = Math.floor((+inputSum.value - +resultSum.innerHTML) * 0.084)
	  localStorage.setItem('result member contribution', resultMc.innerHTML)


	  let sumCupCells = 0
	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('cup-transact')[i].innerHTML
	      sumCupCells += +cell
	  }
	  resultCup.innerHTML = Math.round(sumCupCells * 100) / 100
	  localStorage.setItem('result cup', resultCup.innerHTML)

	  let sumEcupCells = 0
	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('ecup-transact')[i].innerHTML
	      sumEcupCells += +cell
	  }
	  resultEcup.innerHTML = Math.round(sumEcupCells * 100) / 100
	  localStorage.setItem('result ecup', resultEcup.innerHTML)

	  for (let i = 0; i < transactNum; i++) {
	      let cell = document.getElementsByClassName('date-transact')[i].value
	      localStorage.setItem(`date transaction ${i+1}`, cell)
	  }
	  
	  for (let i = 0; i < transactNum; i++) {
	      let cell1 = document.getElementsByClassName('sum-transact')[i].value
	      let cell2 = document.getElementsByClassName('date-transact')[i].value
	      let cell3 = document.getElementsByClassName('day-transact')[i]
	      let cell4 = document.getElementsByClassName('cup-transact')[i]
	      let cell5 = document.getElementsByClassName('ecup-transact')[i]

	      inputDate.value === '' || cell2 === ''
		  ? console.log('Please, choose the date!')
		  : cell3.innerHTML = Math.abs(new Date(inputDate.value) - new Date(cell2)) / 86400000
	      localStorage.setItem(`day transaction ${i+1}`, cell3.innerHTML)
	      
	      cell4.innerHTML = Math.round((+cell1 * 10000 * cell3.innerHTML) / (+inputSum.value * +inputTerm.value) * 100) / 100
	      localStorage.setItem(`cup ${i+1}`, cell4.innerHTML)

	      cell5.innerHTML = Math.round((+cell1 * 10000) / (+inputSum.value * +inputTerm.value) * 100) / 100
	      localStorage.setItem(`ecup ${i+1}`, cell5.innerHTML)


	  }
	  
      }



      
      
      
      //localStorage.setItem('myDataKey', someData);
      //var data = localStorage.getItem('myDataKey');
      //localStorage.removeItem('myDatakey');
      


      

      
					   </script>

    <script>

      console.log("Hi, I’m Rodion. I have a life interest for all things web and developing code. Say Hello!😉")
      
      //change color 
      console.log('Press key "C" to change the color')
      
      let i = 0
      document.onkeydown = () => {
	  if (event.keyCode == 67) {
	      document.querySelector('body').style.filter = `hue-rotate(${i+=45}deg)`
	  } 
      }

</script>


 
  </body>
</html>

